<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http//license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->

<htmlform id="covid19Followup" class="simple-form-ui"
          formName="COVID19 Progress Note"
          formUuid="2bf00b0c-c411-4738-898d-9fac03a60099"
          formEncounterType="ca65f5d3-6312-4143-ae4e-0237427f339e"
          formVersion="1.0">

    <postSubmissionAction class="org.openmrs.module.pihcore.htmlformentry.action.ApplyDispositionAction"/>

    <style type="text/css">

        #who-when-where {
            margin-bottom: 6px;
            border-bottom: 1px solid #ccc;
        }

        #who-when-where p {
            display: inline-block;
            padding-right: 20px;
        }

        #where > input[type=text] {
            display: inline-block;
        }

        .narrow {
            width: 200px;
        }

        .field-error {
            color: #ff6666;
            font-size: 1.1em;
            display: block;
        }

        .simple-form-ui input {
            min-width: 90%
        }

        form fieldset {
            min-width: 90%
        }

        #encounterDate input {
            min-width: 15%
        }

        .section-container {
            background: #F2F2F2;
            box-shadow: 3px 3px 3px 1px rgba(0, 0, 0, 0.2);
            padding: 10px 5px 10px 15px;
            line-height: 1.5em; /*add this for vertical spacing between elements*/
        }

        .section-container input[type="checkbox"] {
            margin: 0px 5px; /*changed values to vertical, horizontal*/
            top:5px; /*added to offset the checkbox position to line up*/
        }

        .section-container label { /*new definition to override labels inside section-containers*/
            margin: 0px;
        }

        .section {
            width: 100%;
        }

        .two-columns {
            column-count: 2;
            -webkit-column-count: 2;
            -moz-column-count: 2;
        }

        .three-columns {
            column-count: 3;
            -webkit-column-count: 3;
            -moz-column-count: 3;
        }

        form input[type="checkbox"], form input[type="radio"],
        .form input[type="checkbox"], .form input[type="radio"] {
            float: none;
            display: inline-block;
        }

        form label, .form label {
            display: inline-block;
        }

        #data-collection {
            display: inline-block;
            width: 58%;
            vertical-align: top;
    </style>

    <ifMode mode="VIEW" include="false">
        <script type="text/javascript">

            var $j = jQuery;

            htmlForm.getBeforeValidation().push(function() {

            var valid = true;

            jq('fieldset.medication').each(function() {

            // clear out any existing error messages
            jq(this).find('.field-error').first().html('');

            //var medication = (jq(this).find('.medication-name input').val()).trim();

            // UHM-3781 we need to look for the value set by the automcomplete widget.
            // The value should be in the format of Drug:DRUG_ID
            var medication = jq(this).find('.medication-name input[type=hidden]').val();

            var dose = jq(this).find('.dose input').val();
            var doseUnits = jq(this).find('.dose-unit select').val();
            var frequency = jq(this).find('.frequency select').val();
            var duration = jq(this).find('.duration input').val();
            var durationUnits = jq(this).find('.duration-unit select').val();
            var instructions = jq(this).find('.medication-instructions input').val();

            if (!medication &amp;&amp; (dose || doseUnits || frequency || duration || durationUnits || instructions)) {
            valid = false;
            jq(this).find('.field-error').first().append("<uimessage
                code="pihcore.visitNote.plan.medications.error.noMedication"/>. ").show();
            }

            if (dose &amp;&amp; !doseUnits) {
            valid = false;
            jq(this).find('.field-error').first().append("<uimessage
                code="pihcore.visitNote.plan.medications.error.noDoseUnits"/>. ").show();
            }

            if (!dose &amp;&amp; doseUnits) {
            valid = false;
            jq(this).find('.field-error').first().append("<uimessage
                code="pihcore.visitNote.plan.medications.error.noDose"/>. ").show();
            }

            if (duration &amp;&amp; !durationUnits) {
            valid = false;
            jq(this).find('.field-error').first().append("<uimessage
                code="pihcore.visitNote.plan.medications.error.noDurationUnits"/>. ").show();
            }

            if (!duration &amp;&amp; durationUnits) {
            valid = false;
            jq(this).find('.field-error').first().append("<uimessage
                code="pihcore.visitNote.plan.medications.error.noDuration"/>. ").show();
            }

            });
            return valid;

            });

            jq(function() {

            var hasValue = function(element) {
            return jq(element).find('.medication-name input').val();
            };

            var hideOtherMeds = function() {
            jq('#medication-2').hide();
            jq('#medication-3').hide();
            jq('#medication-4').hide();
            jq('#medication-5').hide();
            jq('#medication-6').hide();
            jq('#medication-7').hide();
            jq('#medication-8').hide();
            };

            if (!hasValue('#medication-2') &amp;&amp; !hasValue('#medication-3') &amp;&amp; !hasValue('#medication-4')
            &amp;&amp; !hasValue('#medication-5') &amp;&amp; !hasValue('#medication-6') &amp;&amp;
            !hasValue('#medication-7')
            &amp;&amp; !hasValue('#medication-8')) {
            hideOtherMeds();
            jq('#show-more-medications-button').show();
            }

            jq('#show-more-medications-button').click(function() {
            jq('.medication').show();
            jq('#show-more-medications-button').hide();
            jq('#show-less-medications-button').show();
            });

            jq('#show-less-medications-button').click(function() {
            hideOtherMeds();
            jq('#show-less-medications-button').hide();
            jq('#show-more-medications-button').show();
            });

            })

        </script>
    </ifMode>

    <div class="print-form-datestamps" style="display:none">
        <p><uimessage code="pih.form.created_on"/>:
            <lookup complexExpression="$form.dateCreated"/>
        </p>
        <p><uimessage code="pih.form.last_updated_on"/>:
            <lookup complexExpression="$form.dateChanged"/>
        </p>
        <p><uimessage code="pih.form.printed_on"/>:
            <lookup complexExpression="$formGeneratedDatetime"/>
        </p>
    </div>

    <ifMode mode="VIEW" include="false">
        <h2>
            <label>
                <uimessage code="ui.i18n.EncounterType.name.ca65f5d3-6312-4143-ae4e-0237427f339e"/>
            </label>
        </h2>

        <!-- users with retroConsultNote privilege can edit provider, location, and date for both retro and active visits -->
        <includeIf velocityTest="$user.hasPrivilege('Task: emr.retroConsultNote')">
            <div id="who-when-where">
                <p id="who">
                    <label>
                        <uimessage code="emr.patientDashBoard.providerRequired"/>
                    </label>
                    <span>
                        <encounterProviderAndRole default="currentUser"
                                                  encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05" required="true"/>
                    </span>
                </p>
                <p id="where">
                    <label>
                        <uimessage code="emr.locationRequired"/>
                    </label>
                    <span>
                        <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"
                                           tags="COVID-19 Location"/>
                    </span>
                </p>
                <p id="when">
                    <label>
                        <uimessage code="emr.patientDashBoard.date"/>
                    </label>
                    <span>
                        <encounterDate id="encounterDate" default="now"/>
                    </span>
                </p>
            </div>
        </includeIf>

        <!-- users with retroConsultNoteThisProviderOnly can edit location and date (but not provider) for retro visits -->
        <includeIf
                velocityTest="$user.hasPrivilege('Task: emr.retroConsultNoteThisProviderOnly') and !($user.hasPrivilege('Task: emr.retroConsultNote')) and (!$visit.open)">
            <div style="display:none">
                <encounterProviderAndRole default="currentUser" encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05"
                                          required="true"/>
            </div>

            <div id="who-when-where">
                <p id="who">
                    <label>
                        <uimessage code="emr.patientDashBoard.provider"/>
                    </label>
                    <span>
                        <lookup expression="user.person.personName"/>
                    </span>
                </p>
                <p id="where">
                    <label>
                        <uimessage code="emr.locationRequired"/>
                    </label>
                    <span>
                        <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"
                                           tags="COVID-19 Location"/>
                    </span>
                </p>
                <p id="when">
                    <label>
                        <uimessage code="emr.patientDashBoard.date"/>
                    </label>
                    <span>
                        <encounterDate id="encounterDate" default="now"/>
                    </span>
                </p>
            </div>

        </includeIf>

        <!-- all users that don't have retroConsultNote privilege cannot edit provider, location or date when active visit -->
        <includeIf velocityTest="(!$user.hasPrivilege('Task: emr.retroConsultNote')) and ($visit.open)">
            <div style="display:none">
                <encounterProviderAndRole default="currentUser" encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05"
                                          required="true"/>
                <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
                <encounterDate id="encounterDate" default="now"/>
            </div>
            <div id="who-when-where">
                <table id="who-where-when-view">
                    <tr>
                        <td>
                            <label>
                                <uimessage code="emr.patientDashBoard.provider"/>
                            </label>
                            <span>
                                <lookup complexExpression="#if($encounter) $ui.format($encounter.provider) #else $ui.format($user.person) #end"/>
                            </span>
                        </td>
                        <td>
                            <label>
                                <uimessage code="emr.location"/>
                            </label>
                            <span>
                                <lookup complexExpression="#if($encounter) $ui.format($encounter.location) #else $ui.format($sessionContext.sessionLocation) #end"/>
                            </span>
                        </td>
                        <td>
                            <label>
                                <uimessage code="emr.patientDashBoard.date"/>
                            </label>
                            <span>
                                <lookup complexExpression="#if($encounter) $ui.format($fn.startOfDay($encounter.encounterDatetime)) #else $ui.format($fn.startOfDay($formGeneratedDatetime)) #end"/>
                            </span>
                        </td>
                    </tr>
                </table>
            </div>
        </includeIf>
      </ifMode>

    <section id="condition" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="pihcore.healthCondition">
        <div class="section-container">

            <!-- Program enrollment (if the patient hasn't already been enrolled)-->
            <p>
                <enrollInProgram programId="COVID-19"/>
            </p>

            <obs conceptId="CIEL:159640" style="radio"
                 answerConceptIds="CIEL:1498,CIEL:1499,CIEL:1500,CIEL:164830"/>
        </div>
    </section>

    <section id="history" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="zl.consultNote.patientHistory.title">
        <div class="section-container">

            <table>
                <tr>
                    <th>
                       <label>
                           <uimessage code="pihcore.symptoms" />
                       </label>
                    </th>
                    <th>
                        <label>
                            <uimessage code="general.new" />
                        </label>
                    </th>
                    <th>
                    </th>
                </tr>

                <repeat>
                    <template>
                        <obsgroup groupingConceptId="CIEL:1727">
                            <tr>
                                <td>
                                    <obs conceptId="CIEL:1728" style="checkbox"
                                         answerConceptId="{map}" />
                                </td>
                                <td>
                                    <obs conceptId="CIEL:165341" answerConceptId="CIEL:1066"
                                         answerCode="" style="checkbox" />
                                </td>
                                <td>
                                    <obs conceptId="CIEL:162676" style="radio"
                                         answerConceptIds="CIEL:162677,CIEL:162679,CIEL:162678" />
                                </td>
                            </tr>
                        </obsgroup>
                    </template>
                    <render map="CIEL:140238" text="fever" />
                    <render map="CIEL:143264" text="cough" />
                    <render map="CIEL:5957" text="productiveCough" />
                    <render map="CIEL:141600" text="shortOfBreath" />
                    <render map="CIEL:158843" text="soreThroat" />
                    <render map="CIEL:165501" text="runnyNose" />
                    <render map="CIEL:139084" text="headache" />
                    <render map="CIEL:120749" text="chestPain" />
                    <render map="CIEL:133632" text="musclesAcheMyalgias" />
                    <render map="CIEL:140501" text="Fatigue/malaise" />
                    <render map="CIEL:133473" text="Nausea/vomiting" />
                    <render map="CIEL:142412" text="diarrhea" />
                    <render map="CIEL:135588" text="loss of taste" />
                    <render map="CIEL:135589" text="loss of smell" />
                    <render map="CIEL:120345" text="confusion" />
                    <render map="CIEL:125562" text="Suicidal thoughts" />
                    <render map="CIEL:148143" text="Attempted suicide" />
                </repeat>

                <!-- Other symptoms -->
                <tr>
                    <td colspan="3">
                        <obs conceptId="CIEL:165996" style="textarea" rows="3" cols="60"
                             labelCode="zl.ifOtherSpecify"  />
                    </td>
                </tr>
            </table>
        </div>
    </section>

    <section id="vitals" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="pihcore.vitalSigns">
        <div class="section-container">
            <div class="two-columns">
                <p>
                    <label>
                        <uimessage code="mirebalais.vitals.temperature.title"/>
                    </label>
                    <span class="small">
                        <obs conceptId="CIEL:5088" id="temperature_c"
                             showUnits="emr.units.degreesCelsius" unitsCssClass="append-to-value"/>
                    </span>
                </p>

                <p>
                    <label>
                        <uimessage code="mirebalais.vitals.heartRate.title"/>
                    </label>
                    <span class="small">
                        <obs conceptId="CIEL:5087" id="heart_rate"
                             showUnits="emr.units.perMinute" unitsCssClass="append-to-value"/>
                    </span>
                </p>

                <p>
                    <label>
                        <uimessage code="mirebalais.vitals.respiratoryRate.title"/>
                    </label>
                    <span class="small">
                        <obs conceptId="CIEL:5242" id="respiratory_rate"
                             showUnits="emr.units.perMinute" unitsCssClass="append-to-value"/>
                    </span>
                </p>

                <p>
                    <label>
                        <uimessage code="mirebalais.vitals.bloodPressure.title"/>
                    </label>
                    <span class="small">
                        <obs conceptId="CIEL:5085" id="bp_systolic"/>
                    </span>
                    <span class="small">
                        /
                    </span>
                    <span class="small">
                        <obs conceptId="CIEL:5086" id="bp_diastolic"/>
                    </span>
                </p>

                <p>
                    <label>
                        <uimessage code="pihcore.capRefillTime"/>
                    </label>

                    <span class="small">
                        <obs conceptId="CIEL:165890"
                             answerConceptIds="CIEL:165891,CIEL:162512"
                             answerCodes="&lt;3 sec,&gt; 3 sec"
                             style="radio"/>
                    </span>
                    <span class="small">
                        <obs conceptId="CIEL:162513"
                             showUnits="s" unitsCssClass="append-to-value"/>
                    </span>
                </p>

                <p>
                    <obs id="pain" style="radio" conceptId="CIEL:166000"
                         labelCode="pihcore.pain"
                         answerConceptIds="CIEL:1107,CIEL:1498,CIEL:1499,CIEL:1500"/>
                </p>
            </div>

            <p>
                <label>
                    <uimessage code="mirebalais.vitals.o2sat.title"/>
                </label>
                <span class="small">
                    <obs conceptId="CIEL:5092" id="o2_sat"
                         showUnits="emr.units.percent" unitsCssClass="append-to-value"/>
                </span>
                <span class="small">
                    <!-- Room air -->
                    <obs conceptId="CIEL:162739" answerConceptId="CIEL:162735"/>
                </span>
            </p>
        </div>
    </section>

    <section id="physicalexam" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="zl.exam.physicalExam.title">
        <div class="section-container">
            <table>
                <tr>
                    <th>System</th>
                    <th>Normal</th>
                    <th>
                        <label>
                            <uimessage code="pihcore.findings.label" />
                        </label>
                    </th>
                </tr>

                <!-- Physical exam -->
                <repeat with="['general','CIEL:1119','CIEL:163042'],
                              ['heent','CIEL:1122','CIEL:163045'],
                              ['neck','CIEL:163388','CIEL:165983'],
                              ['chest','CIEL:1123','CIEL:160689'],
                              ['cardiac','CIEL:1124','CIEL:163046'],
                              ['abdominal','CIEL:1125','CIEL:160947'],
                              ['urogenital','CIEL:1126','CIEL:163047'],
                              ['rectal','CIEL:163746','CIEL:160961'],
                              ['musculoskeletal','CIEL:1128','CIEL:163048'],
                              ['lymph','CIEL:1121','CIEL:166005'],
                              ['skin','CIEL:1120','CIEL:160981'],
                              ['neuro','CIEL:1129','CIEL:163109']">
                    <tr>
                        <td>
                            <label>
                                <uimessage code="pihcore.exam.{0}_exam" />
                            </label>
                        </td>
                        <td>
                            <obs conceptId="{1}" answerConceptIds="CIEL:1115,CIEL:1116,CIEL:1067"
                                 answerCodes="pihcore.yes.oneChar,pihcore.no.oneChar,pihcore.unknown.oneChar" style="radio" />
                        </td>
                        <td width="60%">
                            <obs conceptId="{2}" />
                        </td>
                    </tr>
                </repeat>

                <tr>
                    <td>
                    </td>
                    <td colspan="2">
                        <repeat with="['Awake','CIEL:160282'],
                                      ['Verbal','CIEL:162645'],
                                      ['Pain','CIEL:162644'],
                                      ['Unresponsive','CIEL:159508]">
                            <obs conceptId="CIEL:162643" answerConceptId="{1}" style="checkbox"/>&amp;nbsp;
                        </repeat>
                    </td>
                </tr>

                <tr>
                    <td colspan="3">
                        <label>
                            <uimessage code="zl.ifOtherSpecify" />
                        </label>
                        <obs conceptId="CIEL:163042" cols="60" />
                    </td>
                </tr>

            </table>
        </div>
    </section>

    <section id="treatment" sectionTag="fieldset" headerTag="legend"
             headerStyle="title" headerCode="pihcore.chemo.treatment">
    <div class="section-container">
            <h3>
                <uimessage code="mirebalais.dispensing.medication"/>
            </h3>
            <p>
                <strong>
                    <uimessage code="pihcore.firstLineMeds"/>
                </strong>
            </p>
            <p>
                <strong>
                    <uimessage code="pihcore.secondLineMeds"/>
                </strong>
                <repeat with="['Lopinavir/Ritonavir','CIEL:794'],
                              ['Remdesivir','CIEL:165878']">
                    <obsgroup groupingConceptId="PIH:Prescription construct">
                        <obs conceptId="PIH:1282" answerConceptId="{1}"
                             style="checkbox"/>
                    </obsgroup>
                    <br/>
                </repeat>
            </p>
            <p>
                <strong>
                    <uimessage code="pihcore.antibiotics"/>
                </strong>

                <repeat with="['Ceftriasone','CIEL:73041'],
                              ['Amoxicillin','CIEL:71160'],
                              ['Doxycycline','CIEL:75222']">
                    <obsgroup groupingConceptId="PIH:Prescription construct">
                        <obs conceptId="PIH:1282" answerConceptId="{1}"
                             style="checkbox"/>
                    </obsgroup>
                    <br/>
                </repeat>
            </p>
            <p>
                <label>
                    <uimessage code="pihcore.otherMeds"/>
                </label>
                <obs conceptId="PIH:Medication comments (text)"
                     style="textarea" rows="3" cols="60"/>
            </p>

            <strong>
                <uimessage code="pihcore.supportiveCare"/>
            </strong>
            <div>
                <div class="two-columns">
                    <obs conceptId="CIEL:165995" style="checkbox"
                         answerConceptId="CIEL:81341"/>
                    <span class="small">
                        <obs conceptId="CIEL:165986" showUnits="true"/>
                    </span>
                    <br/>
                    <br/>
                    <obs conceptId="CIEL:165995"
                         answerConceptId="CIEL:163206" answerCode="pihcore.analgesic"
                         style="checkbox" commentFieldCode="zl.familyHistoryRelativeCheckboxes.specifyLabel"/>
                </div>

                <repeat with="['mechVent','CIEL:165998'],
                              ['mask','CIEL:165989'],
                              ['maskNonReBreather','CIEL:165990']">
                    <obs conceptId="CIEL:165995"
                         answerConceptId="{1}" answerCode="pihcore.{0}"
                         style="checkbox"/>
                </repeat>
                <br/>

                <repeat with="['pihcore.nasalCannula','CIEL:165893'],
                              ['CPAP','CIEL:165944'],
                              ['BiPAP','CIEL:165988'],
                              ['FIO2','CIEL:165927']">
                    <obs conceptId="CIEL:165995"
                         answerConceptId="{1}" answerCode="{0}"
                         style="checkbox"/>
                </repeat>
            </div>

            <div>
                <obs conceptId="CIEL:165995" toggle="ivf"
                     answerConceptId="CIEL:1765" answerCode="pihcore.ivf"
                     style="checkbox"/>

                <div id="ivf">
                    <table>
                        <repeat with="['1'],['2'],['3']">
                            <tr>
                                <td>{0}</td>

                                <td>
                                    <obsgroup groupingConceptId="PIH:IVF construct">
                                        <obs conceptId="CIEL:161911" style="radio"
                                             answerConceptIds="CIEL:78617,CIEL:80804,CIEL:161250"
                                             answerCodes="LR,Normal saline,Dextrose 5%"/>

                                        <p class="small">
                                            <obs conceptId="CIEL:165987" showUnits="true"/>
                                        </p>

                                        <obs conceptId="CIEL:166006" style="radio"
                                             answerConceptIds="CIEL:162625,CIEL:166004"
                                             answerCodes="pihcore.central,pihcore.peripheral"/>

                                    </obsgroup>
                                </td>
                            </tr>
                        </repeat>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <section id="diagnosis" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="pihcore.diagnosis.label">
        <div class="section-container">
            <p>
                <label>
                    COVID-19:
                </label>
                <!-- Confirmed, Suspected, No -->
                <obs conceptId="CIEL:165793" required="true"
                     answerConceptIds="CIEL:159392,CIEL:162743,CIEL:1066" style="radio"/>
            </p>

            <div id="data-collection">
                <encounterDiagnosesByObs selectedDiagnosesTarget="#encounter-diagnoses-target"/>
            </div>
        </div>
    </section>

    <section id="lab" sectionTag="fieldset" headerTag="legend"
             headerStyle="title" headerCode="pihcore.lab.lab_tests.title">
        <div class="section-container">
            <h3>
                <uimessage code="SARS-CoV-2"/>
            </h3>

            <strong><uimessage code="pihcore.antibodyTest" /> </strong><br/>
            <obs conceptId="CIEL:165853" style="radio" id="Ab{0}"
                 answerConceptIds="CIEL:664,CIEL:165855,CIEL:165856,CIEL:165857,CIEL:163611"
                 answerCodes="pihcore.negative,pihcore.posIgM,pihcore.posIgG,pihcore.posIgMandIgG,pihcore.invalid"/>

            <br/>
            <strong><uimessage code="pihcore.antigenTest" /> </strong><br/>
            <obs conceptId="CIEL:165852" style="radio" id="Ag{0}"
                 answerConceptIds="CIEL:664,CIEL:703,CIEL:163611"/>

            <br/>
            <strong><uimessage code="pihcore.rtPCR" /> </strong><br/>
            <obs conceptId="CIEL:165840" style="radio" id="pcr{0}"
                 answerConceptIds="CIEL:664,CIEL:703,CIEL:163611"/>

            <h3>
                <uimessage code="pihcore.lab.abg"/>
            </h3>
            <div class="two-columns">
                <repeat>
                    <template>
                        <label>
                            <uimessage code="{text}"/>
                        </label>
                        <span class="small">
                            <obs conceptId="{map}" showUnits="true"/>
                        </span>
                        <br/>
                    </template>

                    <render map="CIEL:165984" text="pH" />
                    <render map="CIEL:163595" text="PCO2" />
                    <render map="CIEL:163598" text="PO2" />
                    <render map="CIEL:166002" text="TCO2" />
                    <render map="CIEL:163596" text="HCO3" />
                    <render map="CIEL:163599" text="BE" />
                    <render map="CIEL:163597" text="sO2" />
                    <render map="CIEL:165997" text="Lactate" />
                </repeat>
            </div>

        </div>
    </section>

    <section id="radiology-orders" sectionTag="fieldset" headerTag="legend" headerStyle="title"
             headerCode="pihcore.rad_order.title">
        <div class="section-container">
            <includeIf velocityTest="!$config.isComponentEnabled('radiology')">
                <!-- ToDo: Use PACS? -->
                <p>At HUM, use
                    <uimessage code="pihcore.rad_order.title"/>
                </p>
            </includeIf>

            <repeat with="['chestXRay','CIEL:165152'],
                          ['cardioUS','CIEL:163041'],
                          ['abUS','CIEL:845']">
                <p>
                    <obsgroup groupingConceptId="PIH:Radiology report construct">
                        <obs conceptId="PIH:Radiology procedure performed"
                             answerConceptId="{1}" toggle="{0}"
                             answerCode="pihcore.rad.{0}"
                             style="checkbox"/>
                        <br/>
                        <obs id="{0}"
                             conceptId="PIH:Radiology report comments"
                             labelCode="pihcore.findings.label" />
                    </obsgroup>
                </p>
            </repeat>

            <p>
                <label>
                    <uimessage code="zl.ifOtherSpecify"/>
                </label>
                <obsgroup groupingConceptId="PIH:Radiology report construct">
                    <obs conceptId="PIH:Radiology procedure performed"
                         answerClasses="Radiology/Imaging Procedure"
                         style="checkbox"/>
                    <obs conceptId="PIH:Radiology report comments"
                         labelCode="pihcore.findings.label"/>
                </obsgroup>
            </p>
        </div>
    </section>

    <section id="plan" sectionTag="fieldset" headerTag="legend" headerStyle="title"
             headerCode="pihcore.visitNote.plan">
        <div class="section-container">

            <p>
                <div id="disposition">
                    <encounterDisposition/>
                </div>
            </p>

            <strong>
                <uimessage code="pihcore.consult.clinicalManagementPlan"/>
            </strong>
            <p>
                <obs conceptId="CIEL:162749" style="textarea" rows="3" cols="60"/>
            </p>

            <strong>
                <uimessage code="pihcore.nursingAdmitNote"/>
            </strong>
            <p>
                <obs conceptId="CIEL:162879" style="textarea" rows="3" cols="60"/>
            </p>

        </div>
    </section>

    <ifMode mode="VIEW" include="false">
        <div id="buttons">
            <submit submitClass="confirm right" submitCode="mirebalais.save"/>
            <button type="button" class="cancel">
                <uimessage code="emr.cancel"/>
            </button>
        </div>
    </ifMode>

  </htmlform>
